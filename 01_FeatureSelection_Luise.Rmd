---
title: "01_FeatureSelection_Luise"
author: "Sera Choi"
date: "14/05/2021"
output: html_document
---

## Feature selection of Luise's dataset 

* After quality control, normalisation and integration steps were skipped because the dataset has been normalised and stringent experimental design has minimised batch effect 
* Feature selection aims to select genes that carry most interesting biological information, while eliminating those that introduce noise 

```{r, message=FALSE, warning=FALSE}
# Load library
library(Seurat)
library(ggplot2)
library(dplyr)
library(SingleCellExperiment)
library(scater)
library(here)

# Load data
ecpc <- readRDS(here("data/processed/ecpc.RDS")) 
metadata <- ecpc@meta.data #metadata
```

## Visualisation
There are two cells (one from group 1 and the other from group 2), that don't cluster well with others, is that cause of concern? 
```{r}
DimPlot(ecpc, reduction='umap')
DimPlot(ecpc, reduction='tsne')
```
## Feature selection 

```{r, fig.width=10, fig.height=3}
ecpc <- FindVariableFeatures(ecpc, selection.method = "vst", nfeatures=2000)
top10 <- head(VariableFeatures(ecpc), 10)
plot1 <- VariableFeaturePlot(ecpc)
plot2 <- LabelPoints(plot = plot1, points = top10, repel = TRUE)
plot1 + plot2

```






